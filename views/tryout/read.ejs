<% layout('layout/template.ejs') %>
<script type="text/javascript">
    function disableButton(btn) {
        document.getElementById(btn.id).href = "#";
    }
</script>

<h1><%= tryouts.title %> Tryout</h1>
<p><%= tryouts.description %> </p>

<p class="d-inline"></p>
    <% if(!user.admin) { %> 
        <a class="btn btn-primary mb-3" data-bs-toggle="collapse" href="#problem-set" role="button" id="start" aria-expanded="false" aria-controls="collapseExample" onclick="disableButton(this)" >
          Mulai
        </a>
    <% } %>
    <% if(user.admin) { %> 
        <div class="row mb-3 justify-content-start">
            <div class="row row-cols-auto row-cols-sm-auto row-cols-md-auto">
                <div class="col-md-auto mb-2 pe-0">
                    <a href="/tryout/<%= tryouts._id %>/update" class="btn btn-success" role="button">Edit</a>
                </div>
                <div class="col-md-auto mb-2 pe-0">
                    <form action="/tryout/<%= tryouts._id %>?_method=DELETE" method="POST" class="d-inline">
                        <button class="btn btn-danger">Delete</button>
                    </form>
                </div>
                <div class="col-md-auto mb-2 pe-0">
                    <a class="btn btn-warning " data-bs-toggle="collapse" href="#add-question" role="button" id="start" aria-expanded="false" aria-controls="collapseExample">Add Question</a>
                </div>
                <div class="col mb-2 pe-0">
                    <a class="btn btn-primary" data-bs-toggle="collapse" href="#problem-set" role="button" id="start" aria-expanded="false" aria-controls="collapseExample">Problem Set</a>
                </div>
            </div>
        </div>
    <% } %>
</p>
<div class="collapse mb-3" id="add-question">
    <div class="card card-body">
        <div class="form-check mb-3 ps-1 pe-1">
            <form action="/tryout/<%=tryouts._id%>/question" method="POST">
                <label for="question" class="form-label">Question</label>
                <textarea class="form-control mb-3" id="question" name="question[question]" rows="3"></textarea>
                <div class="d-flex align-self-start bd-highlight">
                    <div class="d-flex flex-column bd-highlight mb-3">
                        <% const key = ['a','b','c','d','e'] %> 
                        <% for( let i = 0 ; i < 5 ; i++) { %> 
                            <input type="radio" class="btn-check" id="btn-check-outlined-<%=i%>" name="question[key]" value="<%= key[i] %>" autocomplete="off">
                            <label class="btn btn-outline-primary mb-3" for="btn-check-outlined-<%=i%>">jawaban</label>
                        <% } %> 
                    </div>
                    <div class="d-flex flex-column bd-highlight flex-grow-1 mb-3 ms-2">
                        <% for( let i = 0 ; i < 5 ; i++) { %>
                        <input class="form-control mb-3" type="text" name="question[choice]" id="btn-check-outlined-<%= i%>" value="">
                        <% } %> 
                    </div>
                </div>
                <button class="btn btn-success">Submit</button>
            </form>
        </div>
    </div>
</div>
<div class="collapse mt-3" id="problem-set">
    <div class="card card-body mb-3">
        <% for ( question of tryouts.question) { %>
            <p><%= question.question %> </p>
            <div class="form-check mb-3">
                <% for( let i = 0 ; i < 5 ; i++) { %>
                    <div>
                        <input class="form-check-input" type="radio" name="answer" id="answer" value="option[<%= i %>]">
                        <label class="form-check-label" for="answer">
                          <%= question.choice[i] %> 
                        </label>
                    </div>
                <% } %> 
            </div>
            <p><b>Key: <%= question.key.toUpperCase() %></b></p>
            <div class="row mb-3 justify-content-start">
                <div class="row row-cols-auto row-cols-sm-auto row-cols-md-auto">
                    <div class="col-md-auto mb-2 pe-0">
                        <a href="/tryout/<%= tryouts._id %>/question/<%= question._id %>/update" class="btn btn-success" role="button">Edit</a>
                    </div>
                    <div class="col-md-auto mb-2 pe-0">
                        <form action="/tryout/<%= tryouts._id %>/question/<%= question._id %>?_method=DELETE" method="POST" class="d-inline">
                            <button class="btn btn-danger">Delete</button>
                        </form>
                    </div>
                </div>
            </div>
            <hr class="mt-0">
        <% } %>  
    </div>
</div>